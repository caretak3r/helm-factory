# =============================================================================
# Service Configuration Template
# =============================================================================
serviceName: "complex-app-v2"

# -----------------------------------------------------------------------------
# Platform specific
# -----------------------------------------------------------------------------
pipeline:
  libraryVersion: "0.1.0"
  serviceVersion: "2.0.0"
  chartName: "complex-app-chart"

# -----------------------------------------------------------------------------
# Workload Type Selection
# -----------------------------------------------------------------------------
workload:
  type: StatefulSet

# -----------------------------------------------------------------------------
# Container Image Configuration
# -----------------------------------------------------------------------------
image:
  registry: docker.io
  repository: "redis"
  tag: "6.2.6"

# -----------------------------------------------------------------------------
# Replica Configuration
# -----------------------------------------------------------------------------
replicaCount: 3

# -----------------------------------------------------------------------------
# Service Configuration
# -----------------------------------------------------------------------------
service:
  enabled: true
  type: ClusterIP
  ports:
    - name: redis
      port: 6379
      targetPort: 6379
      protocol: TCP

# -----------------------------------------------------------------------------
# Horizontal Pod Autoscaler
# -----------------------------------------------------------------------------
autoscaling:
  enabled: true
  minReplicas: 3
  maxReplicas: 5
  targetCPU: 80

# -----------------------------------------------------------------------------
# Resource Configuration
# -----------------------------------------------------------------------------
resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 512Mi

# -----------------------------------------------------------------------------
# Probes Configuration
# -----------------------------------------------------------------------------
livenessProbe:
  enabled: true
  tcpSocket:
    port: redis
  initialDelaySeconds: 30

readinessProbe:
  enabled: true
  tcpSocket:
    port: redis

# -----------------------------------------------------------------------------
# Ingress Configuration (Even for Redis? Why not, for admin UI maybe)
# -----------------------------------------------------------------------------
ingress:
  enabled: true
  ingressClassName: "nginx"
  hostname: redis-admin.example.com
  path: /
  pathType: Prefix

# -----------------------------------------------------------------------------
# Persistence / Storage
# -----------------------------------------------------------------------------
persistence:
  enabled: true
  mountPath: /data
  accessModes:
    - ReadWriteOnce
  size: 10Gi
  storageClass: "standard"

# -----------------------------------------------------------------------------
# Service Monitor (Prometheus)
# -----------------------------------------------------------------------------
serviceMonitor:
  enabled: true
  labels:
    release: prometheus

# -----------------------------------------------------------------------------
# CronJob (Backup job)
# -----------------------------------------------------------------------------
cronJob:
  enabled: true
  schedule: "0 2 * * *"
  containers:
    - name: backup
      image: redis:6.2.6
      command: ["/bin/sh", "-c", "echo backup"]