# Default values for platform library chart
# These are overridden by service team configuration.yml

global:
  namespace: default
  environment: production

service:
  name: ""
  type: ClusterIP
  port: 80
  targetPort: 8080

# Workload type: Deployment, StatefulSet, or DaemonSet
# Default is Deployment
workload:
  type: Deployment

deployment:
  replicas: 2
  image:
    repository: ""
    tag: "latest"
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi
  livenessProbe:
    enabled: true
    path: /health
    port: 8080
    initialDelaySeconds: 30
    periodSeconds: 10
  readinessProbe:
    enabled: true
    path: /ready
    port: 8080
    initialDelaySeconds: 10
    periodSeconds: 5

ingress:
  enabled: false
  className: nginx
  annotations: {}
  hosts:
    - host: ""
      paths:
        - path: /
          pathType: Prefix
  tls: []

mtls:
  enabled: false
  policy: STRICT

certificate:
  enabled: false
  issuer: factory-self-ca
  secretName: ""

autoscaling:
  enabled: false
  minReplicas: 2
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80

serviceAccount:
  create: true
  annotations: {}

podSecurityContext:
  fsGroup: 2000

securityContext:
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: false
  runAsNonRoot: true
  runAsUser: 1000

labels: {}
annotations: {}

# StatefulSet specific configuration
statefulset:
  volumeClaimTemplates: []
  # Example:
  # volumeClaimTemplates:
  #   - name: data
  #     storageClassName: fast-ssd
  #     accessModes:
  #       - ReadWriteOnce
  #     storage: 10Gi

# DaemonSet specific configuration
daemonset:
  nodeSelector: {}
  # Example:
  # nodeSelector:
  #   kubernetes.io/os: linux
  tolerations: []
  # Example:
  # tolerations:
  #   - key: node-role.kubernetes.io/master
  #     operator: Exists
  #     effect: NoSchedule

# Job configuration for pre-install and post-install hooks
job:
  # Common job settings (used by both preInstall and postInstall)
  image:
    repository: ""
    tag: "latest"
    pullPolicy: IfNotPresent
  backoffLimit: 3
  completions: 1
  parallelism: 1
  restartPolicy: Never
  activeDeadlineSeconds: 300
  command: []
  args: []
  env: []
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi
  volumeMounts: []
  volumes: []
  
  # Pre-install job (runs before deployment)
  preInstall:
    enabled: false
    hookWeight: -5  # Lower weight = runs earlier
    # Option 1: Inline script (creates ConfigMap automatically)
    # script: |
    #   #!/bin/sh
    #   echo "Running pre-install setup"
    #   # Add your script commands here
    #   exit 0
    # Or as array:
    # script:
    #   - "#!/bin/sh"
    #   - "echo 'Running pre-install setup'"
    #   - "exit 0"
    # Option 2: Script file from repository (relative to chart root)
    # scriptFile: scripts/pre-install.sh
    # Option 3: Custom command and args (if neither script nor scriptFile is set)
    # command:
    #   - /bin/sh
    #   - -c
    # args:
    #   - echo "Running pre-install job"
    # Override common job settings if needed
    # image:
    #   repository: myregistry/pre-install-job
    #   tag: "v1.0.0"
    # env:
    #   - name: ENV_VAR
    #     value: "value"
    # resources:
    #   requests:
    #     cpu: 200m
    #     memory: 256Mi
  
  # Post-install job (runs after deployment)
  postInstall:
    enabled: false
    hookWeight: 5  # Higher weight = runs later
    # Option 1: Inline script (creates ConfigMap automatically)
    # script: |
    #   #!/bin/sh
    #   echo "Running post-install verification"
    #   # Add your script commands here
    #   exit 0
    # Or as array:
    # script:
    #   - "#!/bin/sh"
    #   - "echo 'Running post-install verification'"
    #   - "exit 0"
    # Option 2: Script file from repository (relative to chart root)
    # scriptFile: scripts/post-install.sh
    # Option 3: Custom command and args (if neither script nor scriptFile is set)
    # command:
    #   - /bin/sh
    #   - -c
    # args:
    #   - echo "Running post-install job"
    # Override common job settings if needed
    # image:
    #   repository: myregistry/post-install-job
    #   tag: "v1.0.0"
    # env:
    #   - name: ENV_VAR
    #     value: "value"
    # resources:
    #   requests:
    #     cpu: 200m
    #     memory: 256Mi

